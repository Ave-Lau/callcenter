import{d as e,r as l,S as t,o as a,b2 as o,g as s,f as r,C as i,m as d,w as n,Z as p,i as u,$ as m,V as c,e as f,j as _,aC as j}from"./index.v8tsX86a.js";import{v as b}from"./el-loading.Dm3FsY53.js";import{E as y}from"./el-dialog.DM6VFpK0.js";import"./el-overlay.B3_FyJaS.js";import{a as h,E as g}from"./el-radio.y62okRH8.js";import{E as v}from"./el-input.BsMzjovF.js";import{E as k}from"./el-input-number.D2mjKSLw.js";/* empty css               */import{E as V,a as x}from"./el-select.Gwqp6AQy.js";import"./el-scrollbar.Bhlo5Ad_.js";import"./el-popper.Mqpc2_c2.js";import"./el-tree.Da0rOOXM.js";import"./el-checkbox.pAagPbNv.js";import"./el-text.6IIkvs76.js";import{E as w}from"./el-tree-select.DrzCm6AD.js";import{E as C}from"./el-card.CmKHoQ-9.js";import{E,a as I}from"./el-table-column.B7mJ8jvq.js";import"./el-tooltip.l0sNRNKZ.js";import{a as U,E as q}from"./el-form-item.Bnqn04lm.js";import{E as F}from"./el-button.BLOYf6uz.js";import{D}from"./dept.BUk0DCCn.js";import{E as z}from"./el-message-box.B6ntlUmW.js";import{E as A}from"./index.B_i03TU-.js";import"./index.BPY74GJt.js";import"./use-dialog.W03y6ZLQ.js";import"./index.DXOljNB1.js";import"./error.DLYaCDzj.js";import"./use-form-common-props.BesHhqMc.js";import"./refs.DbUYnDh_.js";import"./index.DkfcTd2R.js";import"./scroll.RmB_wBuD.js";import"./index.DiiUm_IX.js";import"./index.DilPsDsr.js";import"./index.CB15fv5R.js";import"./token.DWNpOE8r.js";import"./strings.BfTlauc4.js";import"./castArray.iqIku5po.js";import"./isEqual.DKtdAyVM.js";import"./_Uint8Array.oWZIoa7E.js";import"./debounce.1urCfl2n.js";import"./_baseIteratee.Dk9qofpS.js";import"./index.BU9_X_cj.js";const B={class:"app-container"},O={class:"search-bar"},R={class:"mb-10px"},T={class:"dialog-footer"},P=e({name:"Dept",inheritAttrs:!1,__name:"index",setup(e){const P=l(),S=l(),$=l(!1),H=l([]),J=t({}),K=t({title:"",visible:!1}),L=l(),M=l(),N=t({status:1,parentId:"0",sort:1}),Q=t({parentId:[{required:!0,message:"上级部门不能为空",trigger:"change"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],code:[{required:!0,message:"部门编号不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function W(){$.value=!0,D.getList(J).then((e=>{L.value=e,$.value=!1}))}function Z(){P.value.resetFields(),W()}function G(e){H.value=e.map((e=>e.id))}async function X(e,l){const t=await D.getOptions();M.value=[{value:"0",label:"顶级部门",children:t}],K.visible=!0,l?(K.title="修改部门",D.getFormData(l).then((e=>{Object.assign(N,e)}))):(K.title="新增部门",N.parentId=e||"0")}function Y(){S.value.validate((e=>{if(e){$.value=!0;const e=N.id;e?D.update(e,N).then((()=>{j.success("修改成功"),le(),W()})).finally((()=>$.value=!1)):D.add(N).then((()=>{j.success("新增成功"),le(),W()})).finally((()=>$.value=!1))}}))}function ee(e){const l=[e||H.value].join(",");l?z.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{$.value=!0,D.deleteByIds(l).then((()=>{j.success("删除成功"),Z()})).finally((()=>$.value=!1))}),(()=>{j.info("已取消删除")})):j.warning("请勾选删除项")}function le(){K.visible=!1,S.value.resetFields(),S.value.clearValidate(),N.id=void 0,N.parentId="0",N.status=1,N.sort=1}return a((()=>{W()})),(e,l)=>{const t=v,a=U,j=x,D=V,z=F,te=q,ae=I,oe=A,se=E,re=C,ie=w,de=k,ne=g,pe=h,ue=y,me=o("hasPerm"),ce=b;return r(),s("div",B,[i("div",O,[d(te,{ref_key:"queryFormRef",ref:P,model:u(J),inline:!0},{default:n((()=>[d(a,{label:"关键字",prop:"keywords"},{default:n((()=>[d(t,{modelValue:u(J).keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>u(J).keywords=e),placeholder:"部门名称",onKeyup:p(W,["enter"])},null,8,["modelValue"])])),_:1}),d(a,{label:"部门状态",prop:"status"},{default:n((()=>[d(D,{modelValue:u(J).status,"onUpdate:modelValue":l[1]||(l[1]=e=>u(J).status=e),placeholder:"全部",clearable:"",class:"!w-[100px]"},{default:n((()=>[d(j,{value:1,label:"正常"}),d(j,{value:0,label:"禁用"})])),_:1},8,["modelValue"])])),_:1}),d(a,null,{default:n((()=>[d(z,{class:"filter-item",type:"primary",icon:"search",onClick:W},{default:n((()=>l[10]||(l[10]=[m(" 搜索 ")]))),_:1,__:[10]}),d(z,{icon:"refresh",onClick:Z},{default:n((()=>l[11]||(l[11]=[m("重置")]))),_:1,__:[11]})])),_:1})])),_:1},8,["model"])]),d(re,{shadow:"never"},{default:n((()=>[i("div",R,[c((r(),f(z,{type:"success",icon:"plus",onClick:l[2]||(l[2]=e=>X())},{default:n((()=>l[12]||(l[12]=[m(" 新增 ")]))),_:1,__:[12]})),[[me,["sys:dept:add"]]]),c((r(),f(z,{type:"danger",disabled:0===u(H).length,icon:"delete",onClick:l[3]||(l[3]=e=>ee())},{default:n((()=>l[13]||(l[13]=[m(" 删除 ")]))),_:1,__:[13]},8,["disabled"])),[[me,["sys:dept:delete"]]])]),c((r(),f(se,{data:u(L),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:G},{default:n((()=>[d(ae,{type:"selection",width:"55",align:"center"}),d(ae,{prop:"name",label:"部门名称","min-width":"200"}),d(ae,{prop:"code",label:"部门编号",width:"200"}),d(ae,{prop:"status",label:"状态",width:"100"},{default:n((e=>[1==e.row.status?(r(),f(oe,{key:0,type:"success"},{default:n((()=>l[14]||(l[14]=[m("正常")]))),_:1,__:[14]})):(r(),f(oe,{key:1,type:"info"},{default:n((()=>l[15]||(l[15]=[m("禁用")]))),_:1,__:[15]}))])),_:1}),d(ae,{prop:"sort",label:"排序",width:"100"}),d(ae,{label:"操作",fixed:"right",align:"left",width:"200"},{default:n((e=>[c((r(),f(z,{type:"primary",link:"",size:"small",icon:"plus",onClick:_((l=>X(e.row.id,void 0)),["stop"])},{default:n((()=>l[16]||(l[16]=[m(" 新增 ")]))),_:2,__:[16]},1032,["onClick"])),[[me,["sys:dept:add"]]]),c((r(),f(z,{type:"primary",link:"",size:"small",icon:"edit",onClick:_((l=>X(e.row.parentId,e.row.id)),["stop"])},{default:n((()=>l[17]||(l[17]=[m(" 编辑 ")]))),_:2,__:[17]},1032,["onClick"])),[[me,["sys:dept:edit"]]]),c((r(),f(z,{type:"danger",link:"",size:"small",icon:"delete",onClick:_((l=>ee(e.row.id)),["stop"])},{default:n((()=>l[18]||(l[18]=[m(" 删除 ")]))),_:2,__:[18]},1032,["onClick"])),[[me,["sys:dept:delete"]]])])),_:1})])),_:1},8,["data"])),[[ce,u($)]])])),_:1}),d(ue,{modelValue:u(K).visible,"onUpdate:modelValue":l[9]||(l[9]=e=>u(K).visible=e),title:u(K).title,width:"600px",onClosed:le},{footer:n((()=>[i("div",T,[d(z,{type:"primary",onClick:Y},{default:n((()=>l[21]||(l[21]=[m("确 定")]))),_:1,__:[21]}),d(z,{onClick:le},{default:n((()=>l[22]||(l[22]=[m("取 消")]))),_:1,__:[22]})])])),default:n((()=>[d(te,{ref_key:"deptFormRef",ref:S,model:u(N),rules:u(Q),"label-width":"80px"},{default:n((()=>[d(a,{label:"上级部门",prop:"parentId"},{default:n((()=>[d(ie,{modelValue:u(N).parentId,"onUpdate:modelValue":l[4]||(l[4]=e=>u(N).parentId=e),placeholder:"选择上级部门",data:u(M),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),d(a,{label:"部门名称",prop:"name"},{default:n((()=>[d(t,{modelValue:u(N).name,"onUpdate:modelValue":l[5]||(l[5]=e=>u(N).name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1}),d(a,{label:"部门编号",prop:"code"},{default:n((()=>[d(t,{modelValue:u(N).code,"onUpdate:modelValue":l[6]||(l[6]=e=>u(N).code=e),placeholder:"请输入部门编号"},null,8,["modelValue"])])),_:1}),d(a,{label:"显示排序",prop:"sort"},{default:n((()=>[d(de,{modelValue:u(N).sort,"onUpdate:modelValue":l[7]||(l[7]=e=>u(N).sort=e),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])])),_:1}),d(a,{label:"部门状态"},{default:n((()=>[d(pe,{modelValue:u(N).status,"onUpdate:modelValue":l[8]||(l[8]=e=>u(N).status=e)},{default:n((()=>[d(ne,{value:1},{default:n((()=>l[19]||(l[19]=[m("正常")]))),_:1,__:[19]}),d(ne,{value:0},{default:n((()=>l[20]||(l[20]=[m("禁用")]))),_:1,__:[20]})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{P as default};
