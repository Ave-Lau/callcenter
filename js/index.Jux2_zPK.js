import{d as e,r as l,S as a,o as t,g as o,f as r,C as s,m as i,w as d,Z as u,i as n,$ as p,V as m,e as c,h as f,E as _,D as y,n as v,F as h,j as b,b8 as k,av as g,aV as V,P as w,Q as U,b4 as j,aI as x}from"./index.BNf4mxQE.js";import{v as E}from"./el-loading.QL51ccJ4.js";import{E as N}from"./el-drawer.CACzoNLp.js";import"./el-overlay.BsvLSXXT.js";import{_ as C}from"./index.Cd-mY9JS.js";import{E as T}from"./el-input.ClClGHKY.js";import{E as A}from"./el-input-number.D19wHfbv.js";import"./el-tooltip.l0sNRNKZ.js";import{E as O}from"./el-popper.B-YX62Un.js";import{a as M,E as I}from"./el-radio.mAwmtY4K.js";/* empty css               */import"./el-select.Csg3qY-Y.js";import"./el-scrollbar.BSUz6fvb.js";import"./el-tree.Dsvcf7n-.js";import"./el-checkbox.DP-pnqmO.js";import"./el-text.DAMXsLTi.js";import{E as L}from"./el-tree-select.BVqUfvgP.js";import{E as P}from"./el-card.dwNzOk9i.js";import{a as G,E as q}from"./el-table-column.CL63ZTZD.js";import{a as B,E as F}from"./el-form-item.DovvAFje.js";import{E as S}from"./el-button.EVl1EmMl.js";import{E as K}from"./el-message-box.CDMpBOcN.js";import{E as R}from"./index.Cx4IHkS0.js";import"./index.l9G2LimK.js";import"./index.CwuJiZnh.js";import"./index.D88KRxG3.js";import"./error.Bg4g5axl.js";import"./scroll.CelKBJpM.js";import"./use-form-common-props.B1WHvisD.js";import"./el-popover.BrOpfnjz.js";import"./dropdown.A2pEcRKV.js";import"./el-tab-pane.0xtBtQkg.js";import"./strings.DaRxdfmw.js";import"./index.D1L5eSjD.js";import"./_plugin-vue_export-helper.BCo6x5W8.js";import"./index.MIo-y8SA.js";import"./index.DzApxU-c.js";import"./index.BWdYtkKV.js";import"./token.DWNpOE8r.js";import"./castArray.N4XM5oBs.js";import"./isEqual.C4vU9DCW.js";import"./_Uint8Array.Cx-nGP6U.js";import"./debounce.ZykLP5uq.js";import"./_baseIteratee.CGENy10K.js";import"./index.B4Ld_3Y0.js";var D=(e=>(e.CATALOG="CATALOG",e.MENU="MENU",e.BUTTON="BUTTON",e.EXTLINK="EXTLINK",e))(D||{});const X={class:"app-container"},z={class:"search-bar"},Q={class:"mb-10px"},$={class:"flex-y-center"},H={class:"flex-y-center"},J={class:"flex-y-center"},W={class:"flex-y-center"},Z={key:0},Y={key:1},ee={class:"flex-y-center"},le={class:"dialog-footer"},ae=e({name:"SysMenu",inheritAttrs:!1,__name:"index",setup(e){const ae=l(),te=l(),oe=l(!1),re=a({title:"新增菜单",visible:!1}),se=a({}),ie=l([]),de=l([]),ue=l({id:void 0,parentId:"0",visible:1,sort:1,type:D.MENU,alwaysShow:0,keepAlive:1,params:[]}),ne=l({...ue.value}),pe=a({parentId:[{required:!0,message:"请选择父级菜单",trigger:"blur"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],type:[{required:!0,message:"请选择菜单类型",trigger:"blur"}],routeName:[{required:!0,message:"请输入路由名称",trigger:"blur"}],routePath:[{required:!0,message:"请输入路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件路径",trigger:"blur"}],visible:[{required:!0,message:"请选择显示状态",trigger:"change"}]}),me=l();function ce(){oe.value=!0,j.getList(se).then((e=>{ie.value=e})).finally((()=>{oe.value=!1}))}function fe(){ae.value.resetFields(),ce()}function _e(e){me.value=e.id}function ye(e,l){j.getOptions(!0).then((e=>{de.value=[{value:"0",label:"顶级菜单",children:e}]})).then((()=>{re.visible=!0,l?(re.title="编辑菜单",j.getFormData(l).then((e=>{ue.value={...e},ne.value=e}))):(re.title="新增菜单",ne.value.parentId=null==e?void 0:e.toString())}))}function ve(){ne.value.type!==ue.value.type&&ne.value.type===D.MENU&&(ue.value.type===D.CATALOG?ne.value.component="":(ne.value.routePath=ue.value.routePath,ne.value.component=ue.value.component))}function he(){te.value.validate((e=>{if(e){const e=ne.value.id;if(e){if(ne.value.parentId==e)return void x.error("父级菜单不能为当前菜单");j.update(e,ne.value).then((()=>{x.success("修改成功"),be(),ce()}))}else j.add(ne.value).then((()=>{x.success("新增成功"),be(),ce()}))}}))}function be(){re.visible=!1,te.value.resetFields(),te.value.clearValidate(),ne.value={id:void 0,parentId:"0",visible:1,sort:1,type:D.MENU,alwaysShow:0,keepAlive:1,params:[]}}return t((()=>{ce()})),(e,l)=>{const a=T,t=B,ue=S,me=F,ke=_,ge=G,Ve=R,we=q,Ue=P,je=L,xe=I,Ee=M,Ne=g("QuestionFilled"),Ce=O,Te=g("CirclePlusFilled"),Ae=g("DeleteFilled"),Oe=A,Me=C,Ie=N,Le=k("hasPerm"),Pe=E;return r(),o("div",X,[s("div",z,[i(me,{ref_key:"queryFormRef",ref:ae,model:n(se),inline:!0},{default:d((()=>[i(t,{label:"关键字",prop:"keywords"},{default:d((()=>[i(a,{modelValue:n(se).keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>n(se).keywords=e),placeholder:"菜单名称",clearable:"",onKeyup:u(ce,["enter"])},null,8,["modelValue"])])),_:1}),i(t,null,{default:d((()=>[i(ue,{type:"primary",icon:"search",onClick:ce},{default:d((()=>l[20]||(l[20]=[p("搜索")]))),_:1,__:[20]}),i(ue,{icon:"refresh",onClick:fe},{default:d((()=>l[21]||(l[21]=[p("重置")]))),_:1,__:[21]})])),_:1})])),_:1},8,["model"])]),i(Ue,{shadow:"never"},{default:d((()=>[s("div",Q,[m((r(),c(ue,{type:"success",icon:"plus",onClick:l[1]||(l[1]=e=>ye("0"))},{default:d((()=>l[22]||(l[22]=[p(" 新增 ")]))),_:1,__:[22]})),[[Le,["sys:menu:add"]]])]),m((r(),c(we,{data:n(ie),"highlight-current-row":"","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},onRowClick:_e},{default:d((()=>[i(ge,{label:"菜单名称","min-width":"200"},{default:d((e=>[e.row.icon&&e.row.icon.startsWith("el-icon")?(r(),c(ke,{key:0,style:{"vertical-align":"-0.15em"}},{default:d((()=>[(r(),c(y(e.row.icon.replace("el-icon-",""))))])),_:2},1024)):e.row.icon?(r(),o("div",{key:1,class:v(`i-svg:${e.row.icon}`)},null,2)):f("",!0),p(" "+h(e.row.name),1)])),_:1}),i(ge,{label:"类型",align:"center",width:"80"},{default:d((e=>[e.row.type===n(D).CATALOG?(r(),c(Ve,{key:0,type:"warning"},{default:d((()=>l[23]||(l[23]=[p("目录")]))),_:1,__:[23]})):f("",!0),e.row.type===n(D).MENU?(r(),c(Ve,{key:1,type:"success"},{default:d((()=>l[24]||(l[24]=[p("菜单")]))),_:1,__:[24]})):f("",!0),e.row.type===n(D).BUTTON?(r(),c(Ve,{key:2,type:"danger"},{default:d((()=>l[25]||(l[25]=[p("按钮")]))),_:1,__:[25]})):f("",!0),e.row.type===n(D).EXTLINK?(r(),c(Ve,{key:3,type:"info"},{default:d((()=>l[26]||(l[26]=[p("外链")]))),_:1,__:[26]})):f("",!0)])),_:1}),i(ge,{label:"路由名称",align:"left",width:"150",prop:"routeName"}),i(ge,{label:"路由路径",align:"left",width:"150",prop:"routePath"}),i(ge,{label:"组件路径",align:"left",width:"250",prop:"component"}),i(ge,{label:"权限标识",align:"center",width:"200",prop:"perm"}),i(ge,{label:"状态",align:"center",width:"80"},{default:d((e=>[1===e.row.visible?(r(),c(Ve,{key:0,type:"success"},{default:d((()=>l[27]||(l[27]=[p("显示")]))),_:1,__:[27]})):(r(),c(Ve,{key:1,type:"info"},{default:d((()=>l[28]||(l[28]=[p("隐藏")]))),_:1,__:[28]}))])),_:1}),i(ge,{label:"排序",align:"center",width:"80",prop:"sort"}),i(ge,{fixed:"right",align:"center",label:"操作",width:"220"},{default:d((e=>["CATALOG"==e.row.type||"MENU"==e.row.type?m((r(),c(ue,{key:0,type:"primary",link:"",size:"small",icon:"plus",onClick:b((l=>ye(e.row.id)),["stop"])},{default:d((()=>l[29]||(l[29]=[p(" 新增 ")]))),_:2,__:[29]},1032,["onClick"])),[[Le,["sys:menu:add"]]]):f("",!0),m((r(),c(ue,{type:"primary",link:"",size:"small",icon:"edit",onClick:b((l=>ye(void 0,e.row.id)),["stop"])},{default:d((()=>l[30]||(l[30]=[p(" 编辑 ")]))),_:2,__:[30]},1032,["onClick"])),[[Le,["sys:menu:edit"]]]),m((r(),c(ue,{type:"danger",link:"",size:"small",icon:"delete",onClick:b((l=>function(e){if(!e)return x.warning("请勾选删除项"),!1;K.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{oe.value=!0,j.deleteById(e).then((()=>{x.success("删除成功"),ce()})).finally((()=>{oe.value=!1}))}),(()=>{x.info("已取消删除")}))}(e.row.id)),["stop"])},{default:d((()=>l[31]||(l[31]=[p(" 删除 ")]))),_:2,__:[31]},1032,["onClick"])),[[Le,["sys:menu:delete"]]])])),_:1})])),_:1},8,["data"])),[[Pe,n(oe)]])])),_:1}),i(Ie,{modelValue:n(re).visible,"onUpdate:modelValue":l[19]||(l[19]=e=>n(re).visible=e),title:n(re).title,size:"50%",onClose:be},{footer:d((()=>[s("div",le,[i(ue,{type:"primary",onClick:he},{default:d((()=>l[56]||(l[56]=[p("确 定")]))),_:1,__:[56]}),i(ue,{onClick:be},{default:d((()=>l[57]||(l[57]=[p("取 消")]))),_:1,__:[57]})])])),default:d((()=>[i(me,{ref_key:"menuFormRef",ref:te,model:n(ne),rules:n(pe),"label-width":"100px"},{default:d((()=>[i(t,{label:"父级菜单",prop:"parentId"},{default:d((()=>[i(je,{modelValue:n(ne).parentId,"onUpdate:modelValue":l[2]||(l[2]=e=>n(ne).parentId=e),placeholder:"选择上级菜单",data:n(de),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),i(t,{label:"菜单名称",prop:"name"},{default:d((()=>[i(a,{modelValue:n(ne).name,"onUpdate:modelValue":l[3]||(l[3]=e=>n(ne).name=e),placeholder:"请输入菜单名称"},null,8,["modelValue"])])),_:1}),i(t,{label:"菜单类型",prop:"type"},{default:d((()=>[i(Ee,{modelValue:n(ne).type,"onUpdate:modelValue":l[4]||(l[4]=e=>n(ne).type=e),onChange:ve},{default:d((()=>[i(xe,{value:"CATALOG"},{default:d((()=>l[32]||(l[32]=[p("目录")]))),_:1,__:[32]}),i(xe,{value:"MENU"},{default:d((()=>l[33]||(l[33]=[p("菜单")]))),_:1,__:[33]}),i(xe,{value:"BUTTON"},{default:d((()=>l[34]||(l[34]=[p("按钮")]))),_:1,__:[34]}),i(xe,{value:"EXTLINK"},{default:d((()=>l[35]||(l[35]=[p("外链")]))),_:1,__:[35]})])),_:1},8,["modelValue"])])),_:1}),"EXTLINK"==n(ne).type?(r(),c(t,{key:0,label:"外链地址",prop:"path"},{default:d((()=>[i(a,{modelValue:n(ne).routePath,"onUpdate:modelValue":l[5]||(l[5]=e=>n(ne).routePath=e),placeholder:"请输入外链完整路径"},null,8,["modelValue"])])),_:1})):f("",!0),n(ne).type==n(D).MENU?(r(),c(t,{key:1,prop:"routeName"},{label:d((()=>[s("div",$,[l[37]||(l[37]=p(" 路由名称 ")),i(Ce,{placement:"bottom",effect:"light"},{content:d((()=>l[36]||(l[36]=[p(" 如果需要开启缓存，需保证页面 defineOptions 中的 name 与此处一致，建议使用驼峰。 ")]))),default:d((()=>[i(ke,{class:"ml-1 cursor-pointer"},{default:d((()=>[i(Ne)])),_:1})])),_:1})])])),default:d((()=>[i(a,{modelValue:n(ne).routeName,"onUpdate:modelValue":l[6]||(l[6]=e=>n(ne).routeName=e),placeholder:"User"},null,8,["modelValue"])])),_:1})):f("",!0),n(ne).type==n(D).CATALOG||n(ne).type==n(D).MENU?(r(),c(t,{key:2,prop:"routePath"},{label:d((()=>[s("div",H,[l[39]||(l[39]=p(" 路由路径 ")),i(Ce,{placement:"bottom",effect:"light"},{content:d((()=>l[38]||(l[38]=[p(" 定义应用中不同页面对应的 URL 路径，目录需以 / 开头，菜单项不用。例如：系统管理目录 /system，系统管理下的用户管理菜单 user。 ")]))),default:d((()=>[i(ke,{class:"ml-1 cursor-pointer"},{default:d((()=>[i(Ne)])),_:1})])),_:1})])])),default:d((()=>[n(ne).type==n(D).CATALOG?(r(),c(a,{key:0,modelValue:n(ne).routePath,"onUpdate:modelValue":l[7]||(l[7]=e=>n(ne).routePath=e),placeholder:"system"},null,8,["modelValue"])):(r(),c(a,{key:1,modelValue:n(ne).routePath,"onUpdate:modelValue":l[8]||(l[8]=e=>n(ne).routePath=e),placeholder:"user"},null,8,["modelValue"]))])),_:1})):f("",!0),n(ne).type==n(D).MENU?(r(),c(t,{key:3,prop:"component"},{label:d((()=>[s("div",J,[l[41]||(l[41]=p(" 组件路径 ")),i(Ce,{placement:"bottom",effect:"light"},{content:d((()=>l[40]||(l[40]=[p(" 组件页面完整路径，相对于 src/views/，如 system/user/index，缺省后缀 .vue ")]))),default:d((()=>[i(ke,{class:"ml-1 cursor-pointer"},{default:d((()=>[i(Ne)])),_:1})])),_:1})])])),default:d((()=>[i(a,{modelValue:n(ne).component,"onUpdate:modelValue":l[9]||(l[9]=e=>n(ne).component=e),placeholder:"system/user/index",style:{width:"95%"}},V({_:2},[n(ne).type==n(D).MENU?{name:"prepend",fn:d((()=>[l[42]||(l[42]=p("src/views/"))])),key:"0"}:void 0,n(ne).type==n(D).MENU?{name:"append",fn:d((()=>[l[43]||(l[43]=p(".vue"))])),key:"1"}:void 0]),1032,["modelValue"])])),_:1})):f("",!0),n(ne).type==n(D).MENU?(r(),c(t,{key:4},{label:d((()=>[s("div",W,[l[45]||(l[45]=p(" 路由参数 ")),i(Ce,{placement:"bottom",effect:"light"},{content:d((()=>l[44]||(l[44]=[p(" 组件页面使用 `useRoute().query.参数名` 获取路由参数值。 ")]))),default:d((()=>[i(ke,{class:"ml-1 cursor-pointer"},{default:d((()=>[i(Ne)])),_:1})])),_:1})])])),default:d((()=>[n(ne).params&&0!==n(ne).params.length?(r(),o("div",Y,[(r(!0),o(w,null,U(n(ne).params,((e,t)=>(r(),o("div",{key:t},[i(a,{modelValue:e.key,"onUpdate:modelValue":l=>e.key=l,placeholder:"参数名",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"]),l[47]||(l[47]=s("span",{class:"mx-1"},"=",-1)),i(a,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:"参数值",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"]),n(ne).params.indexOf(e)===n(ne).params.length-1?(r(),c(ke,{key:0,class:"ml-2 cursor-pointer color-[var(--el-color-success)]",style:{"vertical-align":"-0.15em"},onClick:l[11]||(l[11]=e=>n(ne).params.push({key:"",value:""}))},{default:d((()=>[i(Te)])),_:1})):f("",!0),i(ke,{class:"ml-2 cursor-pointer color-[var(--el-color-danger)]",style:{"vertical-align":"-0.15em"},onClick:l=>n(ne).params.splice(n(ne).params.indexOf(e),1)},{default:d((()=>[i(Ae)])),_:2},1032,["onClick"])])))),128))])):(r(),o("div",Z,[i(ue,{type:"success",plain:"",onClick:l[10]||(l[10]=e=>n(ne).params=[{key:"",value:""}])},{default:d((()=>l[46]||(l[46]=[p(" 添加路由参数 ")]))),_:1,__:[46]})]))])),_:1})):f("",!0),n(ne).type!==n(D).BUTTON?(r(),c(t,{key:5,prop:"visible",label:"显示状态"},{default:d((()=>[i(Ee,{modelValue:n(ne).visible,"onUpdate:modelValue":l[12]||(l[12]=e=>n(ne).visible=e)},{default:d((()=>[i(xe,{value:1},{default:d((()=>l[48]||(l[48]=[p("显示")]))),_:1,__:[48]}),i(xe,{value:0},{default:d((()=>l[49]||(l[49]=[p("隐藏")]))),_:1,__:[49]})])),_:1},8,["modelValue"])])),_:1})):f("",!0),n(ne).type===n(D).CATALOG||n(ne).type===n(D).MENU?(r(),c(t,{key:6},{label:d((()=>[s("div",ee,[l[51]||(l[51]=p(" 始终显示 ")),i(Ce,{placement:"bottom",effect:"light"},{content:d((()=>l[50]||(l[50]=[p(" 选择“是”，即使目录或菜单下只有一个子节点，也会显示父节点。 "),s("br",null,null,-1),p(" 选择“否”，如果目录或菜单下只有一个子节点，则只显示该子节点，隐藏父节点。 "),s("br",null,null,-1),p(" 如果是叶子节点，请选择“否”。 ")]))),default:d((()=>[i(ke,{class:"ml-1 cursor-pointer"},{default:d((()=>[i(Ne)])),_:1})])),_:1})])])),default:d((()=>[i(Ee,{modelValue:n(ne).alwaysShow,"onUpdate:modelValue":l[13]||(l[13]=e=>n(ne).alwaysShow=e)},{default:d((()=>[i(xe,{value:1},{default:d((()=>l[52]||(l[52]=[p("是")]))),_:1,__:[52]}),i(xe,{value:0},{default:d((()=>l[53]||(l[53]=[p("否")]))),_:1,__:[53]})])),_:1},8,["modelValue"])])),_:1})):f("",!0),n(ne).type===n(D).MENU?(r(),c(t,{key:7,label:"缓存页面"},{default:d((()=>[i(Ee,{modelValue:n(ne).keepAlive,"onUpdate:modelValue":l[14]||(l[14]=e=>n(ne).keepAlive=e)},{default:d((()=>[i(xe,{value:1},{default:d((()=>l[54]||(l[54]=[p("开启")]))),_:1,__:[54]}),i(xe,{value:0},{default:d((()=>l[55]||(l[55]=[p("关闭")]))),_:1,__:[55]})])),_:1},8,["modelValue"])])),_:1})):f("",!0),i(t,{label:"排序",prop:"sort"},{default:d((()=>[i(Oe,{modelValue:n(ne).sort,"onUpdate:modelValue":l[15]||(l[15]=e=>n(ne).sort=e),style:{width:"100px"},"controls-position":"right",min:0},null,8,["modelValue"])])),_:1}),n(ne).type==n(D).BUTTON?(r(),c(t,{key:8,label:"权限标识",prop:"perm"},{default:d((()=>[i(a,{modelValue:n(ne).perm,"onUpdate:modelValue":l[16]||(l[16]=e=>n(ne).perm=e),placeholder:"sys:user:add"},null,8,["modelValue"])])),_:1})):f("",!0),n(ne).type!==n(D).BUTTON?(r(),c(t,{key:9,label:"图标",prop:"icon"},{default:d((()=>[i(Me,{modelValue:n(ne).icon,"onUpdate:modelValue":l[17]||(l[17]=e=>n(ne).icon=e)},null,8,["modelValue"])])),_:1})):f("",!0),n(ne).type==n(D).CATALOG?(r(),c(t,{key:10,label:"跳转路由"},{default:d((()=>[i(a,{modelValue:n(ne).redirect,"onUpdate:modelValue":l[18]||(l[18]=e=>n(ne).redirect=e),placeholder:"跳转路由"},null,8,["modelValue"])])),_:1})):f("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{ae as default};
