import{d as e,r as l,S as a,o as t,ao as o,b2 as r,g as s,f as i,C as d,m as u,w as n,Z as p,i as m,$ as c,V as f,e as _,h as y,E as v,D as h,n as b,F as g,j as k,aP as V,P as w,Q as U,a_ as j,aC as x}from"./index.v8tsX86a.js";import{v as E}from"./el-loading.Dm3FsY53.js";import{E as C}from"./el-drawer.BtjMaVqn.js";import"./el-overlay.B3_FyJaS.js";import{_ as N}from"./index.DZi4Ykpf.js";import{E as T}from"./el-input.BsMzjovF.js";import{E as A}from"./el-input-number.D2mjKSLw.js";import"./el-tooltip.l0sNRNKZ.js";import{E as O}from"./el-popper.Mqpc2_c2.js";import{a as M,E as L}from"./el-radio.y62okRH8.js";/* empty css               */import"./el-select.Gwqp6AQy.js";import"./el-scrollbar.Bhlo5Ad_.js";import"./el-tree.Da0rOOXM.js";import"./el-checkbox.pAagPbNv.js";import"./el-text.6IIkvs76.js";import{E as I}from"./el-tree-select.DrzCm6AD.js";import{E as P}from"./el-card.CmKHoQ-9.js";import{E as q,a as G}from"./el-table-column.B7mJ8jvq.js";import{a as B,E as F}from"./el-form-item.Bnqn04lm.js";import{E as S}from"./el-button.BLOYf6uz.js";import{E as K}from"./el-message-box.B6ntlUmW.js";import{E as R}from"./index.B_i03TU-.js";import"./index.BPY74GJt.js";import"./use-dialog.W03y6ZLQ.js";import"./index.DXOljNB1.js";import"./error.DLYaCDzj.js";import"./use-form-common-props.BesHhqMc.js";import"./index.DkfcTd2R.js";import"./scroll.RmB_wBuD.js";import"./el-popover.CRdXsD0d.js";import"./dropdown.DfYR0-7I.js";import"./el-tab-pane.-oCa01p3.js";import"./strings.BfTlauc4.js";import"./index.COuiYCLu.js";import"./_plugin-vue_export-helper.BCo6x5W8.js";import"./index.DiiUm_IX.js";import"./index.DilPsDsr.js";import"./index.CB15fv5R.js";import"./token.DWNpOE8r.js";import"./castArray.iqIku5po.js";import"./isEqual.DKtdAyVM.js";import"./_Uint8Array.oWZIoa7E.js";import"./debounce.1urCfl2n.js";import"./_baseIteratee.Dk9qofpS.js";import"./index.BU9_X_cj.js";var X=(e=>(e.CATALOG="CATALOG",e.MENU="MENU",e.BUTTON="BUTTON",e.EXTLINK="EXTLINK",e))(X||{});const z={class:"app-container"},D={class:"search-bar"},Q={class:"mb-10px"},$={class:"flex-y-center"},H={class:"flex-y-center"},J={class:"flex-y-center"},W={class:"flex-y-center"},Z={key:0},Y={key:1},ee={class:"flex-y-center"},le={class:"dialog-footer"},ae=e({name:"SysMenu",inheritAttrs:!1,__name:"index",setup(e){const ae=l(),te=l(),oe=l(!1),re=a({title:"新增菜单",visible:!1}),se=a({}),ie=l([]),de=l([]),ue=l({id:void 0,parentId:"0",visible:1,sort:1,type:X.MENU,alwaysShow:0,keepAlive:1,params:[]}),ne=l({...ue.value}),pe=a({parentId:[{required:!0,message:"请选择父级菜单",trigger:"blur"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],type:[{required:!0,message:"请选择菜单类型",trigger:"blur"}],routeName:[{required:!0,message:"请输入路由名称",trigger:"blur"}],routePath:[{required:!0,message:"请输入路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件路径",trigger:"blur"}],visible:[{required:!0,message:"请选择显示状态",trigger:"change"}]}),me=l();function ce(){oe.value=!0,j.getList(se).then((e=>{ie.value=e})).finally((()=>{oe.value=!1}))}function fe(){ae.value.resetFields(),ce()}function _e(e){me.value=e.id}function ye(e,l){j.getOptions(!0).then((e=>{de.value=[{value:"0",label:"顶级菜单",children:e}]})).then((()=>{re.visible=!0,l?(re.title="编辑菜单",j.getFormData(l).then((e=>{ue.value={...e},ne.value=e}))):(re.title="新增菜单",ne.value.parentId=null==e?void 0:e.toString())}))}function ve(){ne.value.type!==ue.value.type&&ne.value.type===X.MENU&&(ue.value.type===X.CATALOG?ne.value.component="":(ne.value.routePath=ue.value.routePath,ne.value.component=ue.value.component))}function he(){te.value.validate((e=>{if(e){const e=ne.value.id;if(e){if(ne.value.parentId==e)return void x.error("父级菜单不能为当前菜单");j.update(e,ne.value).then((()=>{x.success("修改成功"),be(),ce()}))}else j.add(ne.value).then((()=>{x.success("新增成功"),be(),ce()}))}}))}function be(){re.visible=!1,te.value.resetFields(),te.value.clearValidate(),ne.value={id:void 0,parentId:"0",visible:1,sort:1,type:X.MENU,alwaysShow:0,keepAlive:1,params:[]}}return t((()=>{ce()})),(e,l)=>{const a=T,t=B,ue=S,me=F,ge=v,ke=G,Ve=R,we=q,Ue=P,je=I,xe=L,Ee=M,Ce=o("QuestionFilled"),Ne=O,Te=o("CirclePlusFilled"),Ae=o("DeleteFilled"),Oe=A,Me=N,Le=C,Ie=r("hasPerm"),Pe=E;return i(),s("div",z,[d("div",D,[u(me,{ref_key:"queryFormRef",ref:ae,model:m(se),inline:!0},{default:n((()=>[u(t,{label:"关键字",prop:"keywords"},{default:n((()=>[u(a,{modelValue:m(se).keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>m(se).keywords=e),placeholder:"菜单名称",clearable:"",onKeyup:p(ce,["enter"])},null,8,["modelValue"])])),_:1}),u(t,null,{default:n((()=>[u(ue,{type:"primary",icon:"search",onClick:ce},{default:n((()=>l[20]||(l[20]=[c("搜索")]))),_:1,__:[20]}),u(ue,{icon:"refresh",onClick:fe},{default:n((()=>l[21]||(l[21]=[c("重置")]))),_:1,__:[21]})])),_:1})])),_:1},8,["model"])]),u(Ue,{shadow:"never"},{default:n((()=>[d("div",Q,[f((i(),_(ue,{type:"success",icon:"plus",onClick:l[1]||(l[1]=e=>ye("0"))},{default:n((()=>l[22]||(l[22]=[c(" 新增 ")]))),_:1,__:[22]})),[[Ie,["sys:menu:add"]]])]),f((i(),_(we,{data:m(ie),"highlight-current-row":"","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},onRowClick:_e},{default:n((()=>[u(ke,{label:"菜单名称","min-width":"200"},{default:n((e=>[e.row.icon&&e.row.icon.startsWith("el-icon")?(i(),_(ge,{key:0,style:{"vertical-align":"-0.15em"}},{default:n((()=>[(i(),_(h(e.row.icon.replace("el-icon-",""))))])),_:2},1024)):e.row.icon?(i(),s("div",{key:1,class:b(`i-svg:${e.row.icon}`)},null,2)):y("",!0),c(" "+g(e.row.name),1)])),_:1}),u(ke,{label:"类型",align:"center",width:"80"},{default:n((e=>[e.row.type===m(X).CATALOG?(i(),_(Ve,{key:0,type:"warning"},{default:n((()=>l[23]||(l[23]=[c("目录")]))),_:1,__:[23]})):y("",!0),e.row.type===m(X).MENU?(i(),_(Ve,{key:1,type:"success"},{default:n((()=>l[24]||(l[24]=[c("菜单")]))),_:1,__:[24]})):y("",!0),e.row.type===m(X).BUTTON?(i(),_(Ve,{key:2,type:"danger"},{default:n((()=>l[25]||(l[25]=[c("按钮")]))),_:1,__:[25]})):y("",!0),e.row.type===m(X).EXTLINK?(i(),_(Ve,{key:3,type:"info"},{default:n((()=>l[26]||(l[26]=[c("外链")]))),_:1,__:[26]})):y("",!0)])),_:1}),u(ke,{label:"路由名称",align:"left",width:"150",prop:"routeName"}),u(ke,{label:"路由路径",align:"left",width:"150",prop:"routePath"}),u(ke,{label:"组件路径",align:"left",width:"250",prop:"component"}),u(ke,{label:"权限标识",align:"center",width:"200",prop:"perm"}),u(ke,{label:"状态",align:"center",width:"80"},{default:n((e=>[1===e.row.visible?(i(),_(Ve,{key:0,type:"success"},{default:n((()=>l[27]||(l[27]=[c("显示")]))),_:1,__:[27]})):(i(),_(Ve,{key:1,type:"info"},{default:n((()=>l[28]||(l[28]=[c("隐藏")]))),_:1,__:[28]}))])),_:1}),u(ke,{label:"排序",align:"center",width:"80",prop:"sort"}),u(ke,{fixed:"right",align:"center",label:"操作",width:"220"},{default:n((e=>["CATALOG"==e.row.type||"MENU"==e.row.type?f((i(),_(ue,{key:0,type:"primary",link:"",size:"small",icon:"plus",onClick:k((l=>ye(e.row.id)),["stop"])},{default:n((()=>l[29]||(l[29]=[c(" 新增 ")]))),_:2,__:[29]},1032,["onClick"])),[[Ie,["sys:menu:add"]]]):y("",!0),f((i(),_(ue,{type:"primary",link:"",size:"small",icon:"edit",onClick:k((l=>ye(void 0,e.row.id)),["stop"])},{default:n((()=>l[30]||(l[30]=[c(" 编辑 ")]))),_:2,__:[30]},1032,["onClick"])),[[Ie,["sys:menu:edit"]]]),f((i(),_(ue,{type:"danger",link:"",size:"small",icon:"delete",onClick:k((l=>function(e){if(!e)return x.warning("请勾选删除项"),!1;K.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{oe.value=!0,j.deleteById(e).then((()=>{x.success("删除成功"),ce()})).finally((()=>{oe.value=!1}))}),(()=>{x.info("已取消删除")}))}(e.row.id)),["stop"])},{default:n((()=>l[31]||(l[31]=[c(" 删除 ")]))),_:2,__:[31]},1032,["onClick"])),[[Ie,["sys:menu:delete"]]])])),_:1})])),_:1},8,["data"])),[[Pe,m(oe)]])])),_:1}),u(Le,{modelValue:m(re).visible,"onUpdate:modelValue":l[19]||(l[19]=e=>m(re).visible=e),title:m(re).title,size:"50%",onClose:be},{footer:n((()=>[d("div",le,[u(ue,{type:"primary",onClick:he},{default:n((()=>l[56]||(l[56]=[c("确 定")]))),_:1,__:[56]}),u(ue,{onClick:be},{default:n((()=>l[57]||(l[57]=[c("取 消")]))),_:1,__:[57]})])])),default:n((()=>[u(me,{ref_key:"menuFormRef",ref:te,model:m(ne),rules:m(pe),"label-width":"100px"},{default:n((()=>[u(t,{label:"父级菜单",prop:"parentId"},{default:n((()=>[u(je,{modelValue:m(ne).parentId,"onUpdate:modelValue":l[2]||(l[2]=e=>m(ne).parentId=e),placeholder:"选择上级菜单",data:m(de),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),u(t,{label:"菜单名称",prop:"name"},{default:n((()=>[u(a,{modelValue:m(ne).name,"onUpdate:modelValue":l[3]||(l[3]=e=>m(ne).name=e),placeholder:"请输入菜单名称"},null,8,["modelValue"])])),_:1}),u(t,{label:"菜单类型",prop:"type"},{default:n((()=>[u(Ee,{modelValue:m(ne).type,"onUpdate:modelValue":l[4]||(l[4]=e=>m(ne).type=e),onChange:ve},{default:n((()=>[u(xe,{value:"CATALOG"},{default:n((()=>l[32]||(l[32]=[c("目录")]))),_:1,__:[32]}),u(xe,{value:"MENU"},{default:n((()=>l[33]||(l[33]=[c("菜单")]))),_:1,__:[33]}),u(xe,{value:"BUTTON"},{default:n((()=>l[34]||(l[34]=[c("按钮")]))),_:1,__:[34]}),u(xe,{value:"EXTLINK"},{default:n((()=>l[35]||(l[35]=[c("外链")]))),_:1,__:[35]})])),_:1},8,["modelValue"])])),_:1}),"EXTLINK"==m(ne).type?(i(),_(t,{key:0,label:"外链地址",prop:"path"},{default:n((()=>[u(a,{modelValue:m(ne).routePath,"onUpdate:modelValue":l[5]||(l[5]=e=>m(ne).routePath=e),placeholder:"请输入外链完整路径"},null,8,["modelValue"])])),_:1})):y("",!0),m(ne).type==m(X).MENU?(i(),_(t,{key:1,prop:"routeName"},{label:n((()=>[d("div",$,[l[37]||(l[37]=c(" 路由名称 ")),u(Ne,{placement:"bottom",effect:"light"},{content:n((()=>l[36]||(l[36]=[c(" 如果需要开启缓存，需保证页面 defineOptions 中的 name 与此处一致，建议使用驼峰。 ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[u(a,{modelValue:m(ne).routeName,"onUpdate:modelValue":l[6]||(l[6]=e=>m(ne).routeName=e),placeholder:"User"},null,8,["modelValue"])])),_:1})):y("",!0),m(ne).type==m(X).CATALOG||m(ne).type==m(X).MENU?(i(),_(t,{key:2,prop:"routePath"},{label:n((()=>[d("div",H,[l[39]||(l[39]=c(" 路由路径 ")),u(Ne,{placement:"bottom",effect:"light"},{content:n((()=>l[38]||(l[38]=[c(" 定义应用中不同页面对应的 URL 路径，目录需以 / 开头，菜单项不用。例如：系统管理目录 /system，系统管理下的用户管理菜单 user。 ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[m(ne).type==m(X).CATALOG?(i(),_(a,{key:0,modelValue:m(ne).routePath,"onUpdate:modelValue":l[7]||(l[7]=e=>m(ne).routePath=e),placeholder:"system"},null,8,["modelValue"])):(i(),_(a,{key:1,modelValue:m(ne).routePath,"onUpdate:modelValue":l[8]||(l[8]=e=>m(ne).routePath=e),placeholder:"user"},null,8,["modelValue"]))])),_:1})):y("",!0),m(ne).type==m(X).MENU?(i(),_(t,{key:3,prop:"component"},{label:n((()=>[d("div",J,[l[41]||(l[41]=c(" 组件路径 ")),u(Ne,{placement:"bottom",effect:"light"},{content:n((()=>l[40]||(l[40]=[c(" 组件页面完整路径，相对于 src/views/，如 system/user/index，缺省后缀 .vue ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[u(a,{modelValue:m(ne).component,"onUpdate:modelValue":l[9]||(l[9]=e=>m(ne).component=e),placeholder:"system/user/index",style:{width:"95%"}},V({_:2},[m(ne).type==m(X).MENU?{name:"prepend",fn:n((()=>[l[42]||(l[42]=c("src/views/"))])),key:"0"}:void 0,m(ne).type==m(X).MENU?{name:"append",fn:n((()=>[l[43]||(l[43]=c(".vue"))])),key:"1"}:void 0]),1032,["modelValue"])])),_:1})):y("",!0),m(ne).type==m(X).MENU?(i(),_(t,{key:4},{label:n((()=>[d("div",W,[l[45]||(l[45]=c(" 路由参数 ")),u(Ne,{placement:"bottom",effect:"light"},{content:n((()=>l[44]||(l[44]=[c(" 组件页面使用 `useRoute().query.参数名` 获取路由参数值。 ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[m(ne).params&&0!==m(ne).params.length?(i(),s("div",Y,[(i(!0),s(w,null,U(m(ne).params,((e,t)=>(i(),s("div",{key:t},[u(a,{modelValue:e.key,"onUpdate:modelValue":l=>e.key=l,placeholder:"参数名",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"]),l[47]||(l[47]=d("span",{class:"mx-1"},"=",-1)),u(a,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:"参数值",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"]),m(ne).params.indexOf(e)===m(ne).params.length-1?(i(),_(ge,{key:0,class:"ml-2 cursor-pointer color-[var(--el-color-success)]",style:{"vertical-align":"-0.15em"},onClick:l[11]||(l[11]=e=>m(ne).params.push({key:"",value:""}))},{default:n((()=>[u(Te)])),_:1})):y("",!0),u(ge,{class:"ml-2 cursor-pointer color-[var(--el-color-danger)]",style:{"vertical-align":"-0.15em"},onClick:l=>m(ne).params.splice(m(ne).params.indexOf(e),1)},{default:n((()=>[u(Ae)])),_:2},1032,["onClick"])])))),128))])):(i(),s("div",Z,[u(ue,{type:"success",plain:"",onClick:l[10]||(l[10]=e=>m(ne).params=[{key:"",value:""}])},{default:n((()=>l[46]||(l[46]=[c(" 添加路由参数 ")]))),_:1,__:[46]})]))])),_:1})):y("",!0),m(ne).type!==m(X).BUTTON?(i(),_(t,{key:5,prop:"visible",label:"显示状态"},{default:n((()=>[u(Ee,{modelValue:m(ne).visible,"onUpdate:modelValue":l[12]||(l[12]=e=>m(ne).visible=e)},{default:n((()=>[u(xe,{value:1},{default:n((()=>l[48]||(l[48]=[c("显示")]))),_:1,__:[48]}),u(xe,{value:0},{default:n((()=>l[49]||(l[49]=[c("隐藏")]))),_:1,__:[49]})])),_:1},8,["modelValue"])])),_:1})):y("",!0),m(ne).type===m(X).CATALOG||m(ne).type===m(X).MENU?(i(),_(t,{key:6},{label:n((()=>[d("div",ee,[l[51]||(l[51]=c(" 始终显示 ")),u(Ne,{placement:"bottom",effect:"light"},{content:n((()=>l[50]||(l[50]=[c(" 选择“是”，即使目录或菜单下只有一个子节点，也会显示父节点。 "),d("br",null,null,-1),c(" 选择“否”，如果目录或菜单下只有一个子节点，则只显示该子节点，隐藏父节点。 "),d("br",null,null,-1),c(" 如果是叶子节点，请选择“否”。 ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[u(Ee,{modelValue:m(ne).alwaysShow,"onUpdate:modelValue":l[13]||(l[13]=e=>m(ne).alwaysShow=e)},{default:n((()=>[u(xe,{value:1},{default:n((()=>l[52]||(l[52]=[c("是")]))),_:1,__:[52]}),u(xe,{value:0},{default:n((()=>l[53]||(l[53]=[c("否")]))),_:1,__:[53]})])),_:1},8,["modelValue"])])),_:1})):y("",!0),m(ne).type===m(X).MENU?(i(),_(t,{key:7,label:"缓存页面"},{default:n((()=>[u(Ee,{modelValue:m(ne).keepAlive,"onUpdate:modelValue":l[14]||(l[14]=e=>m(ne).keepAlive=e)},{default:n((()=>[u(xe,{value:1},{default:n((()=>l[54]||(l[54]=[c("开启")]))),_:1,__:[54]}),u(xe,{value:0},{default:n((()=>l[55]||(l[55]=[c("关闭")]))),_:1,__:[55]})])),_:1},8,["modelValue"])])),_:1})):y("",!0),u(t,{label:"排序",prop:"sort"},{default:n((()=>[u(Oe,{modelValue:m(ne).sort,"onUpdate:modelValue":l[15]||(l[15]=e=>m(ne).sort=e),style:{width:"100px"},"controls-position":"right",min:0},null,8,["modelValue"])])),_:1}),m(ne).type==m(X).BUTTON?(i(),_(t,{key:8,label:"权限标识",prop:"perm"},{default:n((()=>[u(a,{modelValue:m(ne).perm,"onUpdate:modelValue":l[16]||(l[16]=e=>m(ne).perm=e),placeholder:"sys:user:add"},null,8,["modelValue"])])),_:1})):y("",!0),m(ne).type!==m(X).BUTTON?(i(),_(t,{key:9,label:"图标",prop:"icon"},{default:n((()=>[u(Me,{modelValue:m(ne).icon,"onUpdate:modelValue":l[17]||(l[17]=e=>m(ne).icon=e)},null,8,["modelValue"])])),_:1})):y("",!0),m(ne).type==m(X).CATALOG?(i(),_(t,{key:10,label:"跳转路由"},{default:n((()=>[u(a,{modelValue:m(ne).redirect,"onUpdate:modelValue":l[18]||(l[18]=e=>m(ne).redirect=e),placeholder:"跳转路由"},null,8,["modelValue"])])),_:1})):y("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{ae as default};
