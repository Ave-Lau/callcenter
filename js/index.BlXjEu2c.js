import{d as e,r as l,S as t,o as a,g as o,f as s,C as r,m as i,w as d,Z as n,i as p,$ as u,V as m,e as c,j as f,b8 as _,aI as j}from"./index.BNf4mxQE.js";import{v as b}from"./el-loading.QL51ccJ4.js";import{E as h}from"./el-dialog.CSd8OVeO.js";import"./el-overlay.BsvLSXXT.js";import{a as y,E as v}from"./el-radio.mAwmtY4K.js";import{E as g}from"./el-input.ClClGHKY.js";import{E as V}from"./el-input-number.D19wHfbv.js";/* empty css               */import{E as k,a as w}from"./el-select.Csg3qY-Y.js";import"./el-scrollbar.BSUz6fvb.js";import"./el-popper.B-YX62Un.js";import"./el-tree.Dsvcf7n-.js";import"./el-checkbox.DP-pnqmO.js";import"./el-text.DAMXsLTi.js";import{E as x}from"./el-tree-select.BVqUfvgP.js";import{E as C}from"./el-card.dwNzOk9i.js";import{a as E,E as I}from"./el-table-column.CL63ZTZD.js";import"./el-tooltip.l0sNRNKZ.js";import{a as U,E as q}from"./el-form-item.DovvAFje.js";import{E as F}from"./el-button.EVl1EmMl.js";import{D as B}from"./dept.D96qZfWx.js";import{E as D}from"./el-message-box.CDMpBOcN.js";import{E as z}from"./index.Cx4IHkS0.js";import"./index.l9G2LimK.js";import"./refs.Cxh2Q1oA.js";import"./index.CwuJiZnh.js";import"./index.D88KRxG3.js";import"./error.Bg4g5axl.js";import"./scroll.CelKBJpM.js";import"./use-form-common-props.B1WHvisD.js";import"./index.MIo-y8SA.js";import"./index.DzApxU-c.js";import"./index.BWdYtkKV.js";import"./token.DWNpOE8r.js";import"./strings.DaRxdfmw.js";import"./castArray.N4XM5oBs.js";import"./isEqual.C4vU9DCW.js";import"./_Uint8Array.Cx-nGP6U.js";import"./debounce.ZykLP5uq.js";import"./_baseIteratee.CGENy10K.js";import"./index.B4Ld_3Y0.js";const A={class:"app-container"},O={class:"search-bar"},R={class:"mb-10px"},T={class:"dialog-footer"},P=e({name:"Dept",inheritAttrs:!1,__name:"index",setup(e){const P=l(),S=l(),$=l(!1),H=l([]),J=t({}),K=t({title:"",visible:!1}),L=l(),M=l(),N=t({status:1,parentId:"0",sort:1}),Q=t({parentId:[{required:!0,message:"上级部门不能为空",trigger:"change"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],code:[{required:!0,message:"部门编号不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function W(){$.value=!0,B.getList(J).then((e=>{L.value=e,$.value=!1}))}function Z(){P.value.resetFields(),W()}function G(e){H.value=e.map((e=>e.id))}async function X(e,l){const t=await B.getOptions();M.value=[{value:"0",label:"顶级部门",children:t}],K.visible=!0,l?(K.title="修改部门",B.getFormData(l).then((e=>{Object.assign(N,e)}))):(K.title="新增部门",N.parentId=e||"0")}function Y(){S.value.validate((e=>{if(e){$.value=!0;const e=N.id;e?B.update(e,N).then((()=>{j.success("修改成功"),le(),W()})).finally((()=>$.value=!1)):B.add(N).then((()=>{j.success("新增成功"),le(),W()})).finally((()=>$.value=!1))}}))}function ee(e){const l=[e||H.value].join(",");l?D.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{$.value=!0,B.deleteByIds(l).then((()=>{j.success("删除成功"),Z()})).finally((()=>$.value=!1))}),(()=>{j.info("已取消删除")})):j.warning("请勾选删除项")}function le(){K.visible=!1,S.value.resetFields(),S.value.clearValidate(),N.id=void 0,N.parentId="0",N.status=1,N.sort=1}return a((()=>{W()})),(e,l)=>{const t=g,a=U,j=w,B=k,D=F,te=q,ae=E,oe=z,se=I,re=C,ie=x,de=V,ne=v,pe=y,ue=h,me=_("hasPerm"),ce=b;return s(),o("div",A,[r("div",O,[i(te,{ref_key:"queryFormRef",ref:P,model:p(J),inline:!0},{default:d((()=>[i(a,{label:"关键字",prop:"keywords"},{default:d((()=>[i(t,{modelValue:p(J).keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>p(J).keywords=e),placeholder:"部门名称",onKeyup:n(W,["enter"])},null,8,["modelValue"])])),_:1}),i(a,{label:"部门状态",prop:"status"},{default:d((()=>[i(B,{modelValue:p(J).status,"onUpdate:modelValue":l[1]||(l[1]=e=>p(J).status=e),placeholder:"全部",clearable:"",class:"!w-[100px]"},{default:d((()=>[i(j,{value:1,label:"正常"}),i(j,{value:0,label:"禁用"})])),_:1},8,["modelValue"])])),_:1}),i(a,null,{default:d((()=>[i(D,{class:"filter-item",type:"primary",icon:"search",onClick:W},{default:d((()=>l[10]||(l[10]=[u(" 搜索 ")]))),_:1,__:[10]}),i(D,{icon:"refresh",onClick:Z},{default:d((()=>l[11]||(l[11]=[u("重置")]))),_:1,__:[11]})])),_:1})])),_:1},8,["model"])]),i(re,{shadow:"never"},{default:d((()=>[r("div",R,[m((s(),c(D,{type:"success",icon:"plus",onClick:l[2]||(l[2]=e=>X())},{default:d((()=>l[12]||(l[12]=[u(" 新增 ")]))),_:1,__:[12]})),[[me,["sys:dept:add"]]]),m((s(),c(D,{type:"danger",disabled:0===p(H).length,icon:"delete",onClick:l[3]||(l[3]=e=>ee())},{default:d((()=>l[13]||(l[13]=[u(" 删除 ")]))),_:1,__:[13]},8,["disabled"])),[[me,["sys:dept:delete"]]])]),m((s(),c(se,{data:p(L),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:G},{default:d((()=>[i(ae,{type:"selection",width:"55",align:"center"}),i(ae,{prop:"name",label:"部门名称","min-width":"200"}),i(ae,{prop:"code",label:"部门编号",width:"200"}),i(ae,{prop:"status",label:"状态",width:"100"},{default:d((e=>[1==e.row.status?(s(),c(oe,{key:0,type:"success"},{default:d((()=>l[14]||(l[14]=[u("正常")]))),_:1,__:[14]})):(s(),c(oe,{key:1,type:"info"},{default:d((()=>l[15]||(l[15]=[u("禁用")]))),_:1,__:[15]}))])),_:1}),i(ae,{prop:"sort",label:"排序",width:"100"}),i(ae,{label:"操作",fixed:"right",align:"left",width:"200"},{default:d((e=>[m((s(),c(D,{type:"primary",link:"",size:"small",icon:"plus",onClick:f((l=>X(e.row.id,void 0)),["stop"])},{default:d((()=>l[16]||(l[16]=[u(" 新增 ")]))),_:2,__:[16]},1032,["onClick"])),[[me,["sys:dept:add"]]]),m((s(),c(D,{type:"primary",link:"",size:"small",icon:"edit",onClick:f((l=>X(e.row.parentId,e.row.id)),["stop"])},{default:d((()=>l[17]||(l[17]=[u(" 编辑 ")]))),_:2,__:[17]},1032,["onClick"])),[[me,["sys:dept:edit"]]]),m((s(),c(D,{type:"danger",link:"",size:"small",icon:"delete",onClick:f((l=>ee(e.row.id)),["stop"])},{default:d((()=>l[18]||(l[18]=[u(" 删除 ")]))),_:2,__:[18]},1032,["onClick"])),[[me,["sys:dept:delete"]]])])),_:1})])),_:1},8,["data"])),[[ce,p($)]])])),_:1}),i(ue,{modelValue:p(K).visible,"onUpdate:modelValue":l[9]||(l[9]=e=>p(K).visible=e),title:p(K).title,width:"600px",onClosed:le},{footer:d((()=>[r("div",T,[i(D,{type:"primary",onClick:Y},{default:d((()=>l[21]||(l[21]=[u("确 定")]))),_:1,__:[21]}),i(D,{onClick:le},{default:d((()=>l[22]||(l[22]=[u("取 消")]))),_:1,__:[22]})])])),default:d((()=>[i(te,{ref_key:"deptFormRef",ref:S,model:p(N),rules:p(Q),"label-width":"80px"},{default:d((()=>[i(a,{label:"上级部门",prop:"parentId"},{default:d((()=>[i(ie,{modelValue:p(N).parentId,"onUpdate:modelValue":l[4]||(l[4]=e=>p(N).parentId=e),placeholder:"选择上级部门",data:p(M),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),i(a,{label:"部门名称",prop:"name"},{default:d((()=>[i(t,{modelValue:p(N).name,"onUpdate:modelValue":l[5]||(l[5]=e=>p(N).name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1}),i(a,{label:"部门编号",prop:"code"},{default:d((()=>[i(t,{modelValue:p(N).code,"onUpdate:modelValue":l[6]||(l[6]=e=>p(N).code=e),placeholder:"请输入部门编号"},null,8,["modelValue"])])),_:1}),i(a,{label:"显示排序",prop:"sort"},{default:d((()=>[i(de,{modelValue:p(N).sort,"onUpdate:modelValue":l[7]||(l[7]=e=>p(N).sort=e),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])])),_:1}),i(a,{label:"部门状态"},{default:d((()=>[i(pe,{modelValue:p(N).status,"onUpdate:modelValue":l[8]||(l[8]=e=>p(N).status=e)},{default:d((()=>[i(ne,{value:1},{default:d((()=>l[19]||(l[19]=[u("正常")]))),_:1,__:[19]}),i(ne,{value:0},{default:d((()=>l[20]||(l[20]=[u("禁用")]))),_:1,__:[20]})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{P as default};
